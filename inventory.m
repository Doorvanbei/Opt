% base case: loose upper bound
p0 = 100; % fixed
D1 = 20; % fixed
D2 = 200; % expected val = 200 (fixed)
D3 = 300; % expected val = 300 (fixed)
D4 = 500;% fixed
M1 = 5000; % fixed
M2 = 5000; % fixed
M3 = 5000; % fixed
I1 = 5000; % fixed
I2 = 5000; % fixed
I3 = 5000; % fixed
I4 = 5000; % fixed
A =  [0	0	0	0	0	0	1	0	0	-1	0	0
        0	0	0	1	0	0	-1	1	0	1	-1	0
        0	0	0	0	1	0	0	-1	1	0	1	-1
        0	0	0	0	0	1	0	0	-1	0	0	1]; % fixed
b = [D1 - p0,D2,D3,D4 + p0]';
Al = [0	0	0	1	0	0	0	0	0	1	0	0
0	0	0	0	1	0	0	0	0	0	1	0
0	0	0	0	0	1	0	0	0	0	0	1
-M1	0	0	1	0	0	0	0	0	0	0	0
0	-M2	0	0	1	0	0	0	0	0	0	0
0	0	-M3	0	0	1	0	0	0	0	0	0];
bl = [I2,I3,I4,0,0,0]';
intcon = 1:3;
lb = zeros(1,12);
ub = [1,1,1,inf,inf,inf,inf,inf,inf,I1,I2,I3];
% we use the 4 cases: f, f3, f13, f31
f =     [100,100,100, 2,2,2,   4,3,5,   1,1,1]; % [1,1,1,120,300,600,0,0,0,80,0,0]
f3 =    [100,100,100, 2,50,50, 4,10,10, 1,10,10]; % [1,0,0,1020,0,0,0,0,0,80,900,600]
f13 =   [100,100,100, 2,2,50,  4,3,10,  1,1,10]; % [1,1,0,120,900,0,0,0,0,80,0,600]
f31 =   [100,100,100, 2,50,2,  4,10,5,  1,10,1]; % [1,0,1,120,0,900,0,0,300,80,0,0]
% when startup high price -> do not produce
% f1 = [100,1000,100, 2,2,2, 4,3,5, 1,1,1]; % [1,0,1,420,0,600,0,0,0,80,300,0]
% exploit futures
% f2 = [100,100,100,500,500,50,10,10,10,10,10,10]; % [0,0,1,0,0,1020,0,120,420,80,0,0]

% x0 = intlinprog(f3,intcon,Al,bl,A,b,lb,ub)
[x,v,~] = myipb(f31,intcon,Al,bl,A,b,lb,ub)

% ----------------------------------------------------------------------
% Limit effect on M3(production upper limit)
% p0 = 100;
% D1 = 20;
% D2 = 200;
% D3 = 300;
% D4 = 500;
% M1 = 100;
% M2 = 5000;
% M3 = 500;
% I1 = 500;
% I2 = 80;
% I3 = 5000;
% I4 = 5000;
% Aeq = [0	0	0	0	0	0	1	0	0	-1	0	0
% 0	0	0	1	0	0	-1	1	0	1	-1	0
% 0	0	0	0	1	0	0	-1	1	0	1	-1
% 0	0	0	0	0	1	0	0	-1	0	0	1];
% beq = [D1 - p0,D2,D3,D4 + p0];
% A = [0	0	0	1	0	0	0	0	0	1	0	0
% 0	0	0	0	1	0	0	0	0	0	1	0
% 0	0	0	0	0	1	0	0	0	0	0	1
% -M1	0	0	1	0	0	0	0	0	0	0	0
% 0	-M2	0	0	1	0	0	0	0	0	0	0
% 0	0	-M3	0	0	1	0	0	0	0	0	0];
% b = [I2,I3,I4,0,0,0];
% intcon = 1:3;
% lb = zeros(1,12);
% ub = [1,1,1,inf,inf,inf,inf,inf,inf,I1,I2,I3];
% % limit effect on M3
% f = [100,100,100, 4,4,2, 1,1,1, 1,1,1]; % [0,1,1,0,520,500,0,120,0,80,0,100]
% x = intlinprog(f,intcon,A,b,Aeq,beq,lb,ub)

